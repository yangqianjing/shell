## mysql数据库面试总结

### MySQL创建表的时候怎么创建并指定字符集

```shell
在创建表的时候在底部添加 charset utf8;
```

### 数据库默认的库都有什么作用

```shell
mysql库
# 存储数据库的用户,权限等数据

sys库
# 用来存储schema库的配置 s

performance_schema库
# 主要用于收集数据库服务器性能参数

information_schema库
# 保存着关于mysql服务所维护的所有其他数据库的信息,如库名,表,数据类型和访问权限
```

### mysq的几种锁

```shell
表级锁
# 锁定整张表,表级锁包含共享锁和独占锁,使用表级锁定会导致并发性较低

行级锁
# 锁定特定的行,可以使用行级锁定来实现更高的并发性

共享锁
# 允许多个会话同时获取共享锁,进行读取操作

独占锁
# 只有一个会话可以获取独占锁,进行写入操作

页级锁
# 在某些存储引擎中,页级锁是默认的锁级别.允许一定程度的并发性不需要锁定整个表

间隙锁
# 用于锁定某个范围内的数据,而不是具体的行.防止其他会话在某个范围内插入新的数据.确保查询数据的一致性.只要是防止幻读

Next-key locks:
```

### 优化mysql

```shell
1.选择合适的数据类型选择
2.索引优化: 针对不同的字段去设置相对应的索引,但是不能过度的创建索引.
3.分表: 对大型数据表进行分表可以提高查询的效率
4.内存优化: 配置合适的缓冲池大小,减少磁盘IO操作
5.并发连接优化: 根据系统的并发连接和负载特性,调整max_connections参数以支持足够的并发连接
6.硬件升级： 如果以上方法无法满足性能需求，考虑升级硬件，例如增加CPU、内存或者使用SSD等高性能存储设备。
```

### 怎么查询表的前50行

```shell
可以使用limit参数后面跟50,就可以查询到前一张表的前50行数据了
# select * from 表名 limit 50;         
```

### char和varchar的区别

```shell
char是固定长度的字符类型,char之会占用固定的存储空间
varchar:可变长度的字符类型,varchar会占用实际数据的存储空间
char在存取的时候会varchar类型稍快一点,但是在大多数的情况下,性能差异并不明显,存储空间的节省更加重要
```

### sql语句的四大分类

```shell
数据库定义语言  DDL
数据库操纵语言  DML
数据库控制语言  DCL
数据库查询语言  DQL
```

### 什么是锁

```shell
锁是一种机制,用于控制对数据的并发访问,确保数据的一致性和完整性.
锁可以防止多个事务同时修改同一行或同一组相关数据
```

### 锁的优化策略

```shell
1.减少锁的持久时间
2.减少锁的粒度
3.合理选择事务隔离级别
4.使用索引来加速查询
5.避免长时间的事务
```

### 如何不登录mysql执行sql语句

```
使用-e选项后面加需要执行的sql语句
```

### 引擎innodb和myisam的区别

```shell
innodb引擎支持事务处理, myisam不支持事务的处理
innodb使用的是行级锁定,能够提供更好的并发处理能力
myisam引擎使用的表级锁定,可能会导致并发访问量受限制
innodb相对myisam来说占用的磁盘空间会更多,因为他支持事务和行级锁定的特性

innodb支持外键约束,可以保证数据完整性
myisam不支持外键约束
innodb在处理大量写入操作时性能较好
myisam在处理大量读取操作性能较好
```

### 事务的四个特性

```shell
原子性,一致性,隔离性,持久性
=================================
原子性: 事务是应用中最小的执行单位
一致性:事务执行的结果,必须是从一个一致性状态变到另一个一致性状态.要么全部成功要么全部失败
隔离性:当涉及到多用户操作同一张表时，数据库会为每一个用户开启一个事务。各个事务的执行互不干扰，任意一个事务的内部操作对其他并发的事务都是隔离的。
持久性:事务结束后,对数据的修改是永久写入到磁盘中的,即使数据库崩溃.也要保证事务的完整性
```

### msyql索引的描述

```shell
普通索引: 索引的值的重复
唯一索引: 索引的值不能重复,值必须是唯一,可以为空
主键索引: 索引的值不能重复,值必须是唯一,不可以为空
普通索引: 给每一个值都设置索引
```

### 索引对数据的影响

```shell
1.提高查询性能  # 可以加速数据的检索操作,使得查询更加高效
2.降低查询成本  # 使用索引可以降低查询的资源消耗
3.增加写入成本  # 会增加数据写入的成本
4.占用存储空间  # 索引需要额外的存储空间在存储数据结构
```

### sql语句执行慢的原因都有哪几种

```
硬件问题: 磁盘空间不足 IO吞吐量小 网络速度慢
没有索引或者索引过多
数据过多

```

### 数据库类型有哪些

```
非关系型数据库：存储格式灵活，可以是key-value的形式，也可以是文本文档图片等形式。读写速度快，可以使用磁盘或随机存储器作为载体，具有高扩展性，但是不支持sql语句，无事务处理。
关系型数据库：支持事务、使用表结构，可用复杂查询，但是读写性能差，固定表结构，数据存储不够灵活，对于高并发的读写请求，磁盘io是很大的瓶颈。
```

### 主从复制原理

```
主库开启binlog日志，授权用户密码 
从库会开启两个线程io线程和sql线程，主库开启dump线程。当主库binlog日志内容更新后，dump线程会告诉io线程，io线程读取binlog日志，并将内容记录到从库的中继日志，sql线程读取中继日志，并执行，达到数据一致的目的。
```

### 主从方式有哪几种

```
binlog日志方式: 从节点需要手动指定binlog日志的名称,位置
gtid方式: 从节点不需要手动指定binlog日志的名称,位置.会自动锁定
```

### mysql的数据类型

```
非关系型数据库：存储格式灵活，可以是key-value的形式，也可以是文本文档图片等形式。读写速度快，可以使用磁盘或随机存储器作为载体，具有高扩展性，但是不支持sql语句，无事务处理。
关系型数据库：支持事务、使用表结构，可用复杂查询，但是读写性能差，固定表结构，数据存储不够灵活，对于高并发的读写请求，磁盘io是很大的瓶颈。
```

### 主从复制延迟较大的原因

```
主服务器配置高，从服务器的配置低。
并发量大导致主服务器读的慢。从服务器写的慢
网络延迟比较高
从服务器的读写速度慢
```

### mysql主从数据不一致的原因

```
网络延迟: 主从复制是基于binlog的异步复制,通过网络传送binlog文件,所以说网络延迟是大多数引起数据不一致的原因
主从机器的负载不一致：mysql主从复制是主库开启dump线程，从库开启io和sql线程。当任何一台服务器负载过高，导致其中一个线程资源不足，会出现主从不一致的情况
版本不一致: 主从数据库的配置可能不一致，例如不同的存储引擎、不同的字符集设置、不同的时间区域等，这些差异可能导致数据在复制过程中的不一致性。
```

### 读写分离的好处

```
分摊服务器的压力，提高系统的处理效率。主要分担主服务器的读取压力，间接提高了主库的写入性能。因为读请求全部发给了从库
```

### mysqld的优化

```
安全方面：修改默认端口号，禁止root用户远程登录，对用户降权，以普通用户运行mysql
性能方面：升级硬件，内存、磁盘、优化sql语句（开启慢查询）、设置索引
参数优化：innodb的buffer参数调大，连接数调大、缓存的参数优化
架构方面：读写分离，一主多从，高可用

```

### 你是怎么优化sql语句的

```
任何地方都不要使用 select * from t ，用具体的字段列表代替“*”，不要返回用不到的任何字段
避免频繁创建和删除临时表，以减少系统表资源的消耗。
```

